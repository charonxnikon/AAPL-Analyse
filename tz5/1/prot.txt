Script started on Tue Oct  6 16:48:34 2020
[?1034hbash-3.2$ R --no-save <task4.r [1P[1@1

R version 4.0.2 (2020-06-22) -- "Taking Off Again"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R -- ÑÑ‚Ð¾ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ ÐŸÐž, Ð¸ Ð¾Ð½Ð¾ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ÑÑ Ð±ÐµÐ·Ð¾ Ð²ÑÑÐºÐ¸Ñ… Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ð¹.
Ð’Ñ‹ Ð²Ð¾Ð»ÑŒÐ½Ñ‹ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚ÑŒ ÐµÐ³Ð¾ Ð¿Ñ€Ð¸ ÑÐ¾Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ð¸ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… ÑƒÑÐ»Ð¾Ð²Ð¸Ð¹.
Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ 'license()' Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð±Ð¾Ð»ÐµÐµ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸.

R -- ÑÑ‚Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ñ‡Ð°ÐµÑ‚ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð².
Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ 'contributors()' Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¸
'citation()' Ð´Ð»Ñ Ð¾Ð·Ð½Ð°ÐºÐ¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ R Ð¸ ÐµÐ³Ð¾ Ð¿Ð°ÐºÐµÑ‚Ð¾Ð²
Ð² Ð¿ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸ÑÑ….

Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ 'demo()' Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼, 'help()' -- Ð´Ð»Ñ
Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¿Ñ€Ð°Ð²ÐºÐ¸, 'help.start()' -- Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÐ¿Ñ€Ð°Ð²ÐºÐµ Ñ‡ÐµÑ€ÐµÐ· Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€.
Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ 'q()', Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹Ð¹Ñ‚Ð¸ Ð¸Ð· R.

> #Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð¿Ð°ÐºÐµÑ‚Ð° outliers Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ñ„Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ñ… ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÐµÐ² Ð´Ð»Ñ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð² (Ð¨Ð¾Ð²ÐµÐ½Ðµ, Ð“Ñ€Ð°Ð±Ð±ÑÐ°, ÐŸÐ¸Ñ€ÑÐ°, Q-Ñ‚ÐµÑÑ‚ Ð”Ð¸ÐºÑÐ¾Ð½Ð° Ð¸ Ð´Ñ€.) Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…, ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð»Ð¸ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð¼.
> 
> library(outliers)
> library(dplyr)

ÐŸÑ€Ð¸ÑÐ¾ÐµÐ´Ð¸Ð½ÑÑŽ Ð¿Ð°ÐºÐµÑ‚: â€˜dplyrâ€™

Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹ ÑÐºÑ€Ñ‹Ñ‚Ñ‹ Ð¾Ñ‚ â€˜package:statsâ€™:

    filter, lag

Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹ ÑÐºÑ€Ñ‹Ñ‚Ñ‹ Ð¾Ñ‚ â€˜package:baseâ€™:

    intersect, setdiff, setequal, union

> 
> mytest <- function(data)
+ {
+ 	max <- max(data$Close)
+ 	blow_out <- outlier(data$Close, opposite = FALSE ,logical = FALSE)
+ 	if(max == blow_out)
+ 		print("yes, it is: ")
+ 		return (max(data$Close))
+ 	return
+ }
> 
> qtest <- function(data)
+ {
+ 	sort(data$Close)
+ 	tmp <- abs(min-data$Close/dif)
+ 	res = sd(data$Close)/sqrt(length(data$close))
+ 	print("by q-test:")
+ 	return(res)
+ }
> 
> grabs <- function(data)
+ {
+ 	k = 0
+ 	for ( i in data$Close )
+ 		k = k + (i - average)^2
+ 	
+ 	tmp <- sqrt(k/(1550 - 1))
+ 	res <- abs(max - average)/tmp
+ 	print("by grabs:")
+ 	return (res)
+ }
> 
> showen <- function(data)
+ { 
+ 	tmp <- abs(max - average)/dispersion
+ 	res = (1 - tmp)*2
+ 	print("by showen:")
+ 	if (res<0.5)
+ 		print("data Error")
+ 		return 
+ 	return (res)
+ }
> 
> #
> #
> #
> #main
> head <- read.csv("/Users/Nikon/Desktop/CMC MSU/MC/5 sem/Data/AAPL.csv",
+                 header = TRUE)
> num <- read.table("/Users/Nikon/Desktop/CMC MSU/MC/5 sem/Data/table.txt")
> head <- cbind(head, num)
> data <- head[-c(2,3,4,6)]
> data$Date <- as.POSIXct(data$Date)
> data <- mutate_each(data, "factor", Date, Volume)
ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ:
1: `funs_()` is deprecated as of dplyr 0.7.0.
Please use `funs()` instead.
See vignette('programming') for more help
[90mThis warning is displayed once every 8 hours.[39m
[90mCall `lifecycle::last_warnings()` to see where this warning was generated.[39m 
2: `funs()` is deprecated as of dplyr 0.8.0.
Please use a list of either functions or lambdas: 

  # Simple named list: 
  list(mean = mean, median = median)

  # Auto named with `tibble::lst()`: 
  tibble::lst(mean, median)

  # Using lambdas
  list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
[90mThis warning is displayed once every 8 hours.[39m
[90mCall `lifecycle::last_warnings()` to see where this warning was generated.[39m 
3: `mutate_each_()` is deprecated as of dplyr 0.7.0.
Please use `across()` instead.
[90mThis warning is displayed once every 8 hours.[39m
[90mCall `lifecycle::last_warnings()` to see where this warning was generated.[39m 
> glimpse(data)
Rows: 1,510
Columns: 4
$ Date   [3m[38;5;246m<fct>[39m[23m 2014-09-15, 2014-09-16, 2014-09-17, 2014-09-18, 2014-09-19, 20â€¦
$ Close  [3m[38;5;246m<dbl>[39m[23m 25.4075, 25.2150, 25.3950, 25.4475, 25.2400, 25.2650, 25.6600,â€¦
$ Volume [3m[38;5;246m<fct>[39m[23m 245266000, 267632400, 243706000, 149197600, 283609600, 2111536â€¦
$ V1     [3m[38;5;246m<int>[39m[23m 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,â€¦
> hist(data$Close, breaks = 20, freq = FALSE, col = "black",
+ 	xlab = "Price", ylab = "Density", main = "Price")
> lines(density(data$Close), col = "green", lwd = 2)
> 
> min <- min(data$Close)
> max <- max(data$Close)
> dif <- max-min
> average <- mean(data$Close)
> dispersion <- var(data$Close)
> 
> print(mytest(data))
[1] "yes, it is: "
[1] 134.18
> print(showen(data))
[1] "by showen:"
[1] 1.513773
> print(grabs(data))
[1] "by grabs:"
[1] 4.758615
> print(qtest(data))
[1] "by q-test:"
[1] Inf
> 
> 
> 
bash-3.2$ exit
exit

Script done on Tue Oct  6 16:48:39 2020
